using System.Data;

namespace Metro_Rail_DAL.DAL.Budget.Report
{
    public class R12020DAL:CommonDAL
    {
        public DataTable GetAllProjectData()
        {
            DataTable sql = new DataTable();
            sql = Query($"SELECT T_PROJECT_CODE, T_PROJECT_NAME FROM T12003 ORDER BY T_PROJECT_ID  ");
            return sql;
        }
        public DataTable GetBudgetReport(string code)
        {
            DataTable sql = new DataTable();
            sql = Query($"select T_BUDGET_CODE, T_BUDGET_NAME, T_ADP_GOB, T_ADP_PRO_HELP, T_TOTAL_ADP_AMOUNT, T_RADP_GOB, T_RADP_PRO_HELP, T_TOTAL_RADP_AMOUNT, T12010.ACCOUNT_HEADER_NAME, T12010.ACCOUNT_ECONO_CODE, T12010_M.ACCOUNT_HEADER_MAIN_NAME, T12010_M.ACCOUNT_ECONO_MAIN_CODE, T12003.T_PROJECT_NAME, T12003.T_PERIOD_START_DATE, T12003.T_PERIOD_END_DATE from T12020 JOIN T12003 ON T12020.T_PROJECT_CODE=T12003.T_PROJECT_CODE JOIN T12010 ON T12020.T_ACCOUNT_HEADER_CODE=T12010.ACCOUNT_HEADER_CODE JOIN T12010_M ON T12010.ACCOUNT_HEADER_MAIN_CODE =T12010_M.ACCOUNT_HEADER_MAIN_CODE WHERE T12003.T_PROJECT_CODE= '{code}'");
            return sql;
        }
        public DataTable GetFundReport(string code)
        {
            DataTable sql = new DataTable();
            sql = Query($@"SELECT DISTINCT T_BUDGET_ID,T12020.T_PROJECT_CODE,T12003.T_PROJECT_NAME,T_BUDGET_CODE, T_ACCOUNT_HEADER_CODE,T12010.ACCOUNT_ECONO_CODE,T12010.ACCOUNT_HEADER_NAME, T_TOTAL_ADP_AMOUNT,T_TOTAL_RADP_AMOUNT, SUM(AT13002.CREDIT) TOTAL_FUND FROM T12020 JOIN T12003 ON T12020.T_PROJECT_CODE = T12003.T_PROJECT_CODE JOIN T12010 ON T12020.T_ACCOUNT_HEADER_CODE= T12010.ACCOUNT_HEADER_CODE JOIN AT13001 ON T12020.T_PROJECT_CODE=AT13001.T_PROJECT_CODE JOIN AT13002 ON AT13001.VOUCHER_NO = AT13002.VOUCHER_NO AND T12020.T_ACCOUNT_HEADER_CODE =AT13002.ACCOUNT_HEADER_CODE WHERE T12020.T_PROJECT_CODE='{code}' GROUP BY T_BUDGET_ID,T12020.T_PROJECT_CODE,T12003.T_PROJECT_NAME,T_BUDGET_CODE, T_ACCOUNT_HEADER_CODE,T12010.ACCOUNT_ECONO_CODE,T12010.ACCOUNT_HEADER_NAME, T_TOTAL_ADP_AMOUNT,T_TOTAL_RADP_AMOUNT");
            return sql;
        }
        public DataTable GetExpenseReport(string code)
        {
            DataTable sql = new DataTable();
            sql = Query($"SELECT DISTINCT T_BUDGET_ID,T12020.T_PROJECT_CODE,T12003.T_PROJECT_NAME,T_BUDGET_CODE, T_ACCOUNT_HEADER_CODE,T12010.ACCOUNT_ECONO_CODE,T12010.ACCOUNT_HEADER_NAME, T_TOTAL_ADP_AMOUNT,T_TOTAL_RADP_AMOUNT, SUM(AT13002.DEBIT) TOTAL_EXPENSE FROM T12020 JOIN T12003 ON T12020.T_PROJECT_CODE = T12003.T_PROJECT_CODE JOIN T12010 ON T12020.T_ACCOUNT_HEADER_CODE= T12010.ACCOUNT_HEADER_CODE JOIN AT13001 ON T12020.T_PROJECT_CODE=AT13001.T_PROJECT_CODE JOIN AT13002 ON AT13001.VOUCHER_NO = AT13002.VOUCHER_NO AND T12020.T_ACCOUNT_HEADER_CODE =AT13002.ACCOUNT_HEADER_CODE WHERE T12020.T_PROJECT_CODE='{code}' AND AT13001.VAUCHER_TYPE_CODE='101' GROUP BY T_BUDGET_ID,T12020.T_PROJECT_CODE,T12003.T_PROJECT_NAME,T_BUDGET_CODE, T_ACCOUNT_HEADER_CODE,T12010.ACCOUNT_ECONO_CODE,T12010.ACCOUNT_HEADER_NAME, T_TOTAL_ADP_AMOUNT,T_TOTAL_RADP_AMOUNT");
            return sql;
        }
    }
}
